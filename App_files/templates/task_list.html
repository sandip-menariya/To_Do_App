{% extends 'boiler_plate.html' %}

{% block title %} To Do Main {% endblock title %}

{% block body %}
<section class="vh-100 container-fluid" style="background-color: #eee;">
  {% if messages %}
  <div class="alert alert-warning alert-dismissible fade show" role="alert">
    {% for message in messages %}
      {{ message }}
    {% endfor %}
    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
  </div>
  {% endif %} 
  <div class="container py-5 h-100">
     {% if user.is_authenticated %}<div class="row"><div class="col-md-3"><form action="{%  url 'logout' %}" method="post">{% csrf_token %}<input type="submit" value="logout" class="btn btn-outline-danger"></form></div></div> {% endif %}
    <div class="row d-flex justify-content-center align-items-center h-100">
      <div class="col col-lg-9 col-xl-7">
        <div class="card rounded-3">
          <div class="card-body p-4">
            {% if user.is_authenticated %}
            <h4 class="text-center my-3 pb-3">What <span class="text-primary">To Do</span> <span class="text-warning">{{ user.username.capitalize }}!</span></h4>
            <h3 class="text text-center">Add New Task</h3>
            <form method="post" action="{% url 'add_task' %}" class="row row-cols-lg-auto g-3 justify-content-center align-items-center mb-4 pb-2">
                {% csrf_token %}
              <div class="col-lg-12">
                <div data-mdb-input-init class="form-outline">
                {{ form }}                 
                </div>
              </div>
              <div class="col-lg-12 d-flex justify-content-center">
                <button type="submit" data-mdb-button-init data-mdb-ripple-init class="btn btn-primary">Save</button>
              </div>
            </form> 

            <table class="table mb-4">
              <thead>
                <tr>
                  <th scope="col">Task Id</th>
                  <th scope="col">Todo item</th>
                  <th scope="col">Status</th>
                  <th scope="col">Actions</th>
                </tr>
              </thead>
              <tbody>
                {% for task in tasks %}
                <tr>
                  <th scope="row">{{ task.id }}</th>
                  <td>{{ task.title }}</td>
                  <td>{{ task.status }}</td>
                  <td>
                    <a href="{% url 'delete_task' task.id %}" class="btn btn-danger">Delete</a>
                    <a href="{% url 'update_task' task.id %}" class="btn btn-success ms-1">Update</a>
                  </td>
                </tr>
                {% endfor %}
              </tbody>
            </table>
            {% else %}
             <p>Please <a href="{% url 'login' %}">Login</a> or <a href="{% url 'sign_up' %}">Sign-Up</a></p>
            {% endif %}
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
{% endblock body %}